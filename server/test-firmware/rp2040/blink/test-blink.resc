# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# NeuroForge RP2040 Blink Test Script
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# Board: Raspberry Pi Pico (RP2040)
# Firmware: build/blink.elf (Pico SDK)
# Protocol: G:pin=25,v=[0|1]
# UART TCP: localhost:1234
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

using sysbus

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# 1. Criar mรกquina RP2040
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
mach create "pico"

# Carregar plataforma local (custom RP2040)
machine LoadPlatformDescription @platforms/raspberry-pico.repl

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# 2. Carregar firmware ELF
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
sysbus LoadELF @build/blink.elf

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# 3. Configurar UART0 TCP
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
emulation CreateServerSocketTerminal 1234 "uart0" false
connector Connect sysbus.uart0 uart0

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# 4. Configurar Clock
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
sysbus.cpu0 PerformanceInMips 125

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# 5. Mensagens
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo ""
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "  ๐ NeuroForge RP2040 Blink Test"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "  Board:    Raspberry Pi Pico"
echo "  Firmware: build/blink.elf (Pico SDK)"
echo "  UART TCP: localhost:1234"
echo "  Platform: Custom RP2040 .repl"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ก Conectar ao serial:"
echo "   .\\monitor-serial.ps1"
echo ""
echo "๐ Protocolo GPIO:"
echo "   G:pin=25,v=1  (LED ON)"
echo "   G:pin=25,v=0  (LED OFF)"
echo ""
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# 6. Iniciar
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
start

echo "โ Emulaรงรฃo iniciada!"
echo ""
echo "Comandos:"
echo "  pause  - Pausar"
echo "  start  - Continuar"
echo "  quit   - Sair"
echo ""
