// RP2040 MCU - Stable Configuration for Renode 1.16
// Uses MappedMemory to ensure loading, with Tags/Hooks for functionality

// ══════════════════════════════════════════════════════════
// CPU & NVIC
// ══════════════════════════════════════════════════════════
// CPU0 (Cortex-M0+)
cpu0: CPU.CortexM @ sysbus
    cpuType: "cortex-m0+"
    nvic: nvic
    id: 0

// CPU1 (Cortex-M0+) - Halted by default
cpu1: CPU.CortexM @ sysbus
    cpuType: "cortex-m0+"
    nvic: nvic
    id: 1
    init:
        IsHalted true

nvic: IRQControllers.NVIC @ sysbus 0xE000E000
    priorityMask: 0xC0
    systickFrequency: 125000000
    IRQ -> cpu0@0

// ══════════════════════════════════════════════════════════
// MEMORY
// ══════════════════════════════════════════════════════════

sram: Memory.MappedMemory @ sysbus 0x20000000
    size: 0x42000

flash: Memory.MappedMemory @ sysbus 0x10000000
    size: 0x200000

rom: Memory.MappedMemory @ sysbus 0x00000000
    size: 0x4000

// ══════════════════════════════════════════════════════════
// PERIPHERALS (MappedMemory for stability)
// ══════════════════════════════════════════════════════════

resets: Memory.MappedMemory @ sysbus 0x4000C000
    size: 0x1000

clocks: Memory.MappedMemory @ sysbus 0x40008000
    size: 0x1000

timer: Memory.MappedMemory @ sysbus 0x40054000
    size: 0x1000

sio: Memory.MappedMemory @ sysbus 0xD0000000
    size: 0x1000

io_bank0: Memory.MappedMemory @ sysbus 0x40014000
    size: 0x1000

watchdog: Memory.MappedMemory @ sysbus 0x40058000
    size: 0x1000

// UARTs (Using PL011 which is built-in and compatible)
uart0: UART.PL011 @ sysbus 0x40034000
    -> nvic@20

uart1: UART.PL011 @ sysbus 0x40038000
    -> nvic@21

// Other support peripherals
xosc: Memory.MappedMemory @ sysbus 0x40024000
    size: 0x1000

pll_sys: Memory.MappedMemory @ sysbus 0x40028000
    size: 0x1000

pll_usb: Memory.MappedMemory @ sysbus 0x4002C000
    size: 0x1000

syscfg: Memory.MappedMemory @ sysbus 0x4000E000
    size: 0x1000

tbman: Memory.MappedMemory @ sysbus 0x4000F000
    size: 0x1000

psm: Memory.MappedMemory @ sysbus 0x40010000
    size: 0x1000

vreg: Memory.MappedMemory @ sysbus 0x40064000
    size: 0x1000